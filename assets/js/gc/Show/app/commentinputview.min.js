/*! Groovecrowd - v0.0.1 - 2012-07-05
* http://groovecrowd.com
* Includes: commentinputview.js
* Copyright (c) 2012 Jarad DeLorenzo; */
App.CommentInputView=Backbone.View.extend({el:$("#commentInput"),events:{"click .submitComment":"addComment",keypress:"showKey"},initialize:function(){_.bindAll(this,"render","addComment","showKey"),this.model.bind("reset",this.render,this);var a=new App.Comment({id:"next-comment",user:{image:$(this.el).attr("data-image"),first_name:null,last_initial:null},isComment:!1});$(this.el).append((new App.CommentView({model:a})).render().el)},render:function(a){return this},showKey:function(a){a.keyCode==="13"&&this.addComment()},addComment:function(){var a=$("#commentBody").val();if(a==="")return;var b=moment().fromNow(),c=new App.Comment({body:a,user:{image:$(this.el).attr("data-image"),first_name:$(this.el).attr("data-first"),last_initial:$(this.el).attr("data-last")},createdAt:{date:null,formattedDate:b},canDelete:!0});c.save(null,{success:function(a,b){console.log("yay"),$("#commentBody").val("")},error:function(a,b){console.log("error posting comment")}}),App.comments.add(c)}});